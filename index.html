<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pay Naija - Login</title>
    <link rel='icon' href='img/PayNaija.png' type='image/x-icon' sizes="16x16" />
    <!-- Import Google font and icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Work+Sans:400,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="bootstrap-4.5.0-dist/css/bootstrap.min.css">
    <link href="style.css" rel="stylesheet">
    <link href="https://cdn.materialdesignicons.com/4.8.95/css/materialdesignicons.min.css" rel="stylesheet">
    <link href="flashjs-master/dist/flash.min.css" rel="stylesheet">
</head>
<body>
          
          <div class="container">

            
            <div class="flash-container">
              <div class="flash-message"></div>
          </div>

            <div class="row">

               <!-- first column -->
               <div class="col-sm-12 col-lg-6 d-none d-md-block mt-5">
                <img src="img/transfer.svg" alt="login" class="img-fluid mt-5" alt="login" />
              </div>


              <!-- second column -->
              <div class="col-sm-12 col-lg-6">
                
                <div style="margin-top: 50px;" class="text-center">
                  <img src="img/PayNaija.png" class="" alt="logo" width="100" height="50" />
                </div>

                  <div class="text-center">
                    <h6 style="font-size: 25px;" class="mt-4">Welcome Back!</h6>
                  </div>

              <form style="width: 80%; margin: auto;">
      
                  <div class="form-group mt-4">
                    <label for="email">Email address</label>
                    <input type="email" class="form-control" id="email" required>
                  </div>

                  <div class="form-group">
                    <label for="password">Password</label>
                    <div class="input-group mb-2" id="show_hide_password">
                        <input type="password" class="form-control" id="password">
                        <div class="input-group-prepend">
                            <div class="input-group-text">
                                <a href=""><i class="fa fa-eye-slash" aria-hidden="true"></i></a>
                            </div>
                          </div>
                      </div>
                </div>
                
                <button type="submit" class="btn btn-primary mt-2" style="width: 100%;" >Sign In <span id="spinner"></span></button>

                <div class="text-right" style="margin-top: 10px;">
                  <a href="forgot-password.html" style="text-decoration: none;" class="text-color">Forgot password?</a>
                </div>
                  
              </form>


              <div class="text-center" style="margin-top: 70px;">
              <p>Don't have an account? <a href="register.html" style="text-decoration: none;" class="text-color">Click here to register</a></p>
              </div>

              </div>

             
            </div>


          </div>

        

    








<script src="dist/jquery.min.js"></script>
<script src="bootstrap-4.5.0-dist/js/bootstrap.min.js"></script>
<script src="lib/viewdata.js"></script>
<script src="lib/jquery.cookie.js"></script>
<script src="https://kit.fontawesome.com/d54c227c34.js"></script>
 <!-- Forms Validations Plugin -->
 <script src="/assets/js/plugins/jquery.validate.min.js"></script>
 <script src="iziToast-master/dist/js/iziToast.min.js"></script>
 <script src="flashjs-master/dist/flash.min.js"></script>
 <script src="flashjs-master/dist/flash.jquery.min.js"></script>
  <script>
    $(document).ready(function(){

      
      $("#show_hide_password a").on('click', function(event) {
             event.preventDefault();
        if($('#show_hide_password input').attr("type") == "text"){
            $('#show_hide_password input').attr('type', 'password');
            $('#show_hide_password i').addClass( "fa-eye-slash" );
            $('#show_hide_password i').removeClass( "fa-eye" );
        }else if($('#show_hide_password input').attr("type") == "password"){
            $('#show_hide_password input').attr('type', 'text');
            $('#show_hide_password i').removeClass( "fa-eye-slash" );
            $('#show_hide_password i').addClass( "fa-eye" );
        }
    });

      $("form").submit(function(event) {

        event.preventDefault();
        var view_data = new ViewData();
        var login_function = "authenticateuser";

        var email = $("#email").val();
        var password = $("#password").val();
        var url = view_data.ControllerRouteURL + login_function;

        var data={
          email: email,
          password: password
        }

        $.ajax({
                type: 'POST',
                data: JSON.stringify(data),
                url: url,
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
            beforeSend: function(jqXHR, settings) {
                $('#spinner').addClass("fa fa-circle-o-notch fa-spin");
            },
            success: function(data) {
               console.log(data)
                view_data.storeUserDetails("token", data["token"]);
                // view_data.storeUserDetails("firstName", data["firstName"]);
                // view_data.storeUserDetails("lastName", data["lastName"]);
                window.location.replace("home.html");
            },
            error: function(data){
                $('#spinner').removeClass("fa fa-circle-o-notch fa-spin");
                $('.flash-message').flashjs({
                        timeout: 2000,
                        progress: true,
                    });
                $('.flash-message').text('Invalid Credentials')
                
            },
            complete: function(jqXHR) {
                if (jqXHR.status != '200') {
                    var obj = $.parseJSON(jqXHR.responseText);
                }
                $('#spinner').removeClass("fa fa-circle-o-notch fa-spin");
            }
        });

});

    })
      
  </script>  
</body>
</html>